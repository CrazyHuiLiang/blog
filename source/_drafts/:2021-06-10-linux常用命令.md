---
title: linux常用命令
comments: true
date: 2021-06-10 22:10:37
tags:
---

## 初体验

| 命令      | 作用            |
|---------|---------------|
| cal     | 查看日历          |
| passwd  | 修改用户密码        |
| ls      | 查看目录和文件       |
| whoami  | 查看当前用户信息      |
| users   | 查看当前在线用户      |
| who     | 查看当前在线用户      |
| w       | 查看当前在线用户      |
| logout  | 退出登录          |

关机：

| 命令       | 作用                           |
|----------|------------------------------|
| halt     | 直接关闭系统                       | 
| init 0   | 使用预先定义的脚本关闭系统，关闭前可以清理和更新有关信息 |
| init 6   | 重新启动系统                       |
| poweroff | 通过断电来关闭系统                    |
| reboot   | 重新启动系统                       |
| shutdown | 安全关闭系统                       |


### 元字符

元字符是具有特殊含义的字符。`*` 和 `?` 都是元字符：

* `*`可以匹配 0 个或多个任意字符；
* `?` 匹配一个字符。

例如:

```
ls ch*.doc
```

### 隐藏文件

隐藏文件的第一个字符为英文句号或点号(`.`)，Linux程序（包括Shell）通常使用隐藏文件来保存配置信息。

下面是一些常见的隐藏文件：

| 文件         | 描述                       |
|------------|--------------------------|
| .profile   | Bourne shell (sh) 初始化脚本  |
| .kshrc     | Korn shell (ksh) 初始化脚本   |
| .cshrc     | C shell (csh) 初始化脚本      |
| .rhosts    | Remote shell (rsh) 配置文件  |

查看隐藏文件需要使用 `ls` 命令的 `-a` 选项：

## 编辑文件（vi）

命令：

```
vi filename 
```

创建文件 filename 并打开，按下 `i` 键即可进入编辑模式，你可以向文件中写入内容

完成编辑后，可以按 `esc` 键退出编辑模式，也可以按组合键 `Shift + ZZ` 完全退出文件。这样，就完成了文件的创建。

当文件被打开后，可以按 `i` 键进入编辑模式，按照自己的方式编辑文件。如果想移动光标，必须先按 `esc `键退出编辑模式，然后使用下面的按键在文件内移动光标：

| 快捷键    | 作用     |
|--------|--------|
| l      | 键向右移动  |
| h      | 键向左移动  |
| k      | 键向上移动  |
| j      | 键向下移动  |

使用上面的按键，可以将光标快速定位到你想编辑的地方。



## 标准的Linux流

一般情况下，每个Linux程序运行时都会创建三个文件流（三个文件）：

* 标准输入流(stdin)：stdin的文件描述符为0，Linux程序默认从stdin读取数据。
* 标准输出流(stdout)：stdout 的文件描述符为1，Linux程序默认向stdout输出数据。
* 标准错误流(stderr)：stderr的文件描述符为2，Linux程序会向stderr流中写入错误信息。


## Linux文件权限和访问模式

为了更加安全的存储文件，Linux为不同的文件赋予了不同的权限，每个文件都拥有下面三种权限：

| 权限             | 说明                |
|----------------|-------------------|
| 所有者权限          | 文件所有者能够进行的操作      |
| 组权限            | 文件所属用户组能够进行的操作    |
| 外部权限（其他权限）     | 其他用户可以进行的操作。      |

使用 ls -l 命令可以查看与文件权限相关的信息，如：

```
ls -l /home/amrood
```

第一列就包含了文件或目录的权限，第一列的字符可以分为三组，每一组有三个，每个字符都代表不同的权限，分别为读取(r)、写入(w)和执行(x)：

| 组           | 说明                                                    |
|-------------|-------------------------------------------------------|
| 第一组字符(2-4)  | 表示文件所有者的权限，-rwxr-xr-- 表示所有者拥有读取(r)、写入(w)和执行(x)的权限。    |
| 第二组字符(5-7)  | 表示文件所属用户组的权限，-rwxr-xr-- 表示该组拥有读取(r)和执行(x)的权限，但没有写入权限。 |
| 第三组字符(8-10) | 表示所有其他用户的权限，rwxr-xr-- 表示其他用户只能读取(r)文件。                |

文件访问模式，文件权限是Linux系统的第一道安全防线，基本的权限有读取(r)、写入(w)和执行(x)：

| 模式 | 说明                                                       |
| ---- | ---------------------------------------------------------- |
| 读取 | 用户能够读取文件信息，查看文件内容。                       |
| 写入 | 用户可以编辑文件，可以向文件写入内容，也可以删除文件内容。 |
| 执行 | 用户可以将文件作为程序来运行。                             |

目录访问模式，目录的访问模式和文件类似，但是稍有不同：

| 模式 | 说明                                                     |
| ---- | -------------------------------------------------------- |
| 读取 | 用户可以查看目录中的文件                                 |
| 写入 | 用户可以在当前目录中删除文件或创建文件                   |
| 执行 | 执行权限赋予用户遍历目录的权利，例如执行 cd 和 ls 命令。 |

## 改变权限

可以使用 `chmod` (change mode) 命令来改变文件或目录的访问权限，权限可以使用符号或数字来表示。
使用符号表示权限

file
r: cat/more/head/tail/less
w:vim
x:script command
directory:
r: ls
w: touch/mkdir/rmdir/rm
x: cd
语法： chmod [{ugoa} {+-=} {rwx}] [文件或目录]
-R 递归修改
对于初学者来说最简单的就是使用符号来改变文件或目录的权限，你可以增加(+)和删除(-)权限，也可以指定特定权限。

| 符号 | 说明 |
| ---- | ---- |

+ | 为文件或目录增加权限

- | 删除文件或目录的权限
  =	| 设置指定的权限

  chmod u+r index.html
  chmod g=rw index.html
  chmod o+r index.html

使用数字表示权限

除了符号，也可以使用八进制数字来指定具体权限，如下表所示：

| 数字 | 说明               | 权限                                  |
| ---- | ------------------ | ------------------------------------- |
| 0    | 没有任何权限       | ---                                   |
| 1    | 执行权限           | --x                                   |
| 2    | 写入权限           | -w-                                   |
| 3    | 执行权限和写入权限 | 1 (执行) + 2 (写入) = 3-wx            |
| 4    | 读取权限           | r--                                   |
| 5    | 读取和执行权限     | 4 (读取) + 1 (执行) = 5r-x            |
| 6    | 读取和写入权限     | 4 (读取) + 2 (写入) = 6rw-            |
| 7    | 所有权限           | 4 (读取) + 2 (写入) + 1 (执行) = 7rwx |

r  --4
w  --2
x  --1
例子：

```
chmod 777 index.html 
```

##更改所有者和用户组

在Linux中，每添加一个新用户，就会为它分配一个用户ID和群组ID，上面提到的文件权限也是基于用户和群组来分配的。

有两个命令可以改变文件的所有者或群组：
chown：chown 命令是"change owner"的缩写，用来改变文件的所有者，只有root才能使用。
chgrp：chgrp 命令是"change group"的缩写，用来改变文件所在的群组。

```
 chown user filelist
 chown amrood testfile
 
 注意：超级用户 root 可以不受限制的更改文件的所有者。
```

SUID和SGID位

为一个目录设置SUID和SGID位可以使用下面的命令：

```
chmod ug+s dirname
```

##Linux环境变量

变量就是一个可以被赋值的字符串，赋值范围包括数字、文本、文件名、设备以及其他类型的数据。

```
	设置变量：
	a="I am Bill"

	使用变量时在变量前方添加$符号，如：
	echo $a

	结果是： 
	I am Bill
```

登录系统后，Shell会有一个初始化的过程，用来设置环境变量。这个阶段，Shell会读取 /etc/profile 和 .profile 两个文件，过程如下：

Shell首先检查 /etc/profile 文件是否存在，如果存在，就读取内容，否则就跳过，但是不会报错。

然后检查你的主目录（登录目录）中是否存在 .profile 文件，如果存在，就读取内容，否则就跳过，也不会报错。

读取完上面两个文件，Shell就会出现\$命令提示符：

```
$
```

出现这个提示符，就可以输入命令并调用相应的程序了。

注意：上面是Bourne Shell的初始化过程，bash 和 ksh 在初始化过程中还会检查其他文件。

###PS1和PS2变量

PS1变量用来保存命令提示符，可以随意修改，如果你不习惯使用 $ 作为提示符，也可以改成其他字符。PS1变量被修改后，提示符会立即改变。

如果用户输入的命令不完整，Shell还会使用第二提示符来等待用户完成命令的输入。默认的第二命令提示符是 >，保存在 PS2 变量，可以随意修改。

```
修改配置文件后，如需立即生效需要使用source命令，如：

$ source .profile

或者重新进入shell
```

##locale

查看当前系统语言环境

```
locale
```

查看已安装的系统语言环境

```
locale -a
```

更新语言包

```
locale-gen 
```

更新／安装单个语言包

```
locale-gen 语言包名称

如：
locale-gen zh_CN.UTF-8
``
```

## 管道和过滤器

有时候，我们可以把两个命令连起来使用，一个命令的输出作为另一个命令的输入，这就叫做管道。为了建立管道，需要在两个命令之间使用竖线(|)连接。

管道是Linux进程之间一种重要的通信机制；除了管道，还有共享内存、消息队列、信号、套接字(socket) 等进程通信机制。

管道使用竖线(|)将两个命令隔开，竖线左边命令的输出就会作为竖线右边命令的输入。连续使用竖线表示第一个命令的输出会作为第二个命令的输入，第二个命令的输出又会作为第三个命令的输入，依此类推。

###grep命令

grep 是一个强大的文本搜索工具，可以使用正则表达式，并返回匹配的行，语法为：

```
$grep pattern file(s)
```

| 选项 | 说明                                                                             |
| ---- | -------------------------------------------------------------------------------- |
| -v   | 反转查询，输出不匹配的行。例如，grep -v "test" demo.txt 将输出不包含"test"的行。 |
| -n   | 输出匹配的行以及行号。                                                           |
| -l   | 输出匹配的行所在的文件名。                                                       |
| -c   | 输出匹配的总行数。                                                               |
| -i   | 不区分大小写进行匹配。                                                           |

### sort命令

sort 命令在 Linux 中非常有用，它将文件中的各行按字母或数进行排序。sort命令既可以从特定的文件，也可以从stdin获取输入

| 选项 | 描述                                                                 |
| ---- | -------------------------------------------------------------------- |
| -n   | 按照数字大小排序，例如，10会排在2后面；-n 选项会忽略空格或 tab缩进。 |
| -r   | 降序排序。sort 默认是升序排序。                                      |
| -f   | 不区分大小写。                                                       |
| +x   | 对第x列（从0开始）进行排序。                                         |

### pg和more命令

如果文件内容过多，全部显示会很乱，可以使用 pg 和 more/less 命令分页显示，每次只显示一屏，按空格键(space)/f可以查看下一屏,b查看上页。
查看过程中使用/key 进行搜索

head -n 行号  查看前n行
tail -n 行号  查看末位n行
-f 动态显示文件末位内容

## 进程管理

当我们运行程序时，Linux会为程序创建一个特殊的环境，该环境包含程序运行需要的所有资源，以保证程序能够独立运行，不受其他程序的干扰。这个特殊的环境就称为进程。

系统通过一个五位数字跟踪程序的运行状态，这个数字称为 pid 或进程ID。每个进程都拥有唯一的 pid。

#### 前台进程

默认情况下，用户创建的进程都是前台进程；前台进程从键盘读取数据，并把处理结果输出到显示器。

当程序运行在前台时，由于命令提示符($)还未出现，用户不能输入其他命令；即使程序需要运行很长时间，也必须等待程序运行结束才能输入其他命令。

#### 后台进程

后台进程的优点是不必等待程序运行结束就可以输入其他命令。

创建后台进程最简单的方式就是在命令的末尾加 &

#### 查看正在运行的进程

可以使用 ps 命令查看进程的运行状态，包括后台进程

#### top命令

### ln 链接

ln /原文件 /目标文件   创建链接
-s 创建软连接
软连接
只是源文件的一个链接，占用磁盘很小一块位置。所有权限都rwx，使用权限为源文件权限，更改权限也会作用到源文件。
可以跨分区
可以针对目录使用
ls -l查看时第一项第一个字母为l,文件名有一个明显的文件指向
硬链接
是源文件的一个完整的拷贝,
硬链接的inode与源文件一致，所有硬链接文件可以和源文件同步更新。
不能跨分区
不能针对目录使用

比如我在目录
/usr/local/Cellar/node/5.0.0/lib/node_modules/bower/bin
中，想要把当前目录下的bower 软连接到  /usr/local/bin/bower

不可以
ln -s bower /usr/local/bin/bower

而应该把全路径都写出来

ln -s /usr/local/Cellar/node/5.0.0/lib/node_modules/bower/bin/bower /usr/local/bin/bower

./bower 也不行，必须全目录

## 网络通信工具

### ping 命令

ping 命令会向网络上的主机发送应答请求，根据响应信息可以判断远程主机是否可用。
-c 指定发送次数
ping 命令的语法：

```
$ping hostname or ip-address
```
