---
title: Linux笔记
comments: true
date: 2018-02-02 22:23:07
tags: Linux
---

## 安装Linux

主要有两大系列：

* redhat
* debian、ubuntu

#### 分区

把大硬盘分为小的逻辑分区

* 主分区： 最多4个
* 扩展分区
* 高级分区

#### 格式化

主要目的写入文件系统，将磁盘分成小数据块，并创建inode。

#### 硬件设备文件名

| 硬件    | 设备文件名               |
|-------|--------------------------|
| IDE硬盘 | /dev/hd[a-d]            |
| 鼠标    | /dev/mouse              |
|  光驱   | /dev/cdrom 或/dev/sr0   |


#### 挂载

给每个分区设置挂载点。（ windows中称为分配盘符）

* 必须分区
    *  / 根分区
    *  swap 交换分区（安装虚拟机时，建议为内存两倍，不超过2GB）
* 推荐分区
    * /boot  启动分区 200MB


## 配置ip

查看当前所有up状态的网卡信息

```shell
$ ifconfig 
```
| 名称    | 概念                              |
|-------|------------------------------------|
| lo    | loopback回环网卡，代表本机，用于本机测试 |
| eth0  | 网卡                                |

常用命令
```shell
# 查看eth0网卡信息
$ ifconfig eth0

# 配置网卡eth0 ip地址
$ ifconfig eth0 192.168.1.2
# 配置网卡 eth0 ip地址，子网掩码，广播地址
$ ifconfig eth0 192.168.1.2 netmask 255.255.255.0 broadcast 192.168.2.255

# 启动eth0网卡
$ ifconfig eth0 up
# 关闭eth0网卡
$ ifconfig eth0 down

# 开启网卡eth0的arp协议
$ ifconfig eth0 arp
# 关闭网卡eth0的arp协议
$ ifconfig eth0 -arp
```

## 远程登录

配置完成ip后，可以使用ssh登录机器
```shell
# 使用 root 用户登录 192.168.1.2 机器
$ ssh root@192.168.1.2
```

相关软件：SecureCRT, winscp, xmanager, vnc


## 常用命令

通常命令格式：

```
命令 [-选项] [参数]
```

1. 个别命令使用不遵守此格式
2. 当有多个选项时，可以写在一起
3. 简化选项与完整选项


#### ls

列取目录内容

```shell
$ ls -ls file_name/dir_name
```

参数说明：

* `-a` 等于 --all，可以查看所有文件，包括隐藏文件
* `-h` 人性化显示
* `-d` 显示当前目录本身
* `-i` 显示inode节点号
* `-l` 可以查看更多信息

使用 `ls -l` 列出信息每列含义如下：


| 列数      | 含义                                 |
|---------|------------------------------------|
| 第一列     | 文件类型。                              |
| 第二列     | 表示文件引用计数。                          |
| 第三列     | 文件的所有者，即文件的创建者。                    |
| 第四列     | 文件所有者所在的用户组。在Linux中，每个用户都隶属于一个用户组。 |
| 第五列     | 文件大小（以字节计）。                        |
| 第六列     | 文件被创建或上次被修改的时间。                    |
| 第七列     | 文件名或目录名。                           |


通过 `ls -l` 列出的文件，每一行都是以 a、d、- 或 l 开头，这些字符表示文件类型：

| 前缀    | 描述                                                  |
|-------|-----------------------------------------------------|
| -     | 普通文件。如文本文件、二进制可执行文件、源代码等。                           |
| b	    | 块设备文件。硬盘可以使用块设备文件。                                  |
| c	    | 字符设备文件。硬盘也可以使用字符设备文件。                               |
| d	    | 目录文件。目录可以包含文件和其他目录。                                 |
| l	    | 符号链接（软链接）。可以链接任何普通文件，类似于 Windows 中的快捷方式。            |
| p	    | 具名管道。管道是进程间的一种通信机制。                                 |
| s	    | 用于进程间通信的套接字。                                        |

提示：通俗的讲软连接就是windows的快捷方式，原来文件删了，快捷方式虽然在但是不起作用了。


#### mkdir

```shell
$ mkdir directory_name
```

* `-p` 递归创建，如果上级目录不存在，就会报错，为 `mkdir` 命令增加 `-p` 选项，可以一级一级创建所需要的目录，即使上级目录不存在也不会报错


#### rmdir

删除空目录

```shell
$ rmdir 目录名
```

#### cd

切换目录

```shell
$ cd 目录名|..|. 
```

#### pwd

打印当前目录

```shell
$ pwd
```


#### wc

统计单词数目 ，可以使用 `wc` 命令来统计当前文件的行数、单词数和字符数，下面是一个简单的例子：

```
wc filename
```

每一列的含义如下：

| 列       | 作用                   |
|---------|----------------------|
| 第一列     | 文件的总行数               |
| 第二列     | 单词数目                 |
| 第三列     | 文件的字节数，即文件的大小        |
| 第四列     | 文件名                  |

也可以一次查看多个文件的内容，例如：

```shell
$ wc filename1 filename2 filename3
```

#### cp

复制

```shell
$ cp srcPath1 srcPath2 ... destPath
```

* -r 复制文件夹时同时改名称，复制文件夹需要加上 -r 参数
* -p 保留属性

#### mv

移动／更名

```shell
$ mv  srcPath1 srcPath2 ... destPath
```

#### rm

删除
```shell
$ rm path1 path2 ...
```

* -f 强制删除（不提示确认）
* -r 删除目录

#### touch

创建文件/更改最后修改时间

```shell
$ touch 文件名
```

#### cat

查询文件内容
```shell
$ cat 文件名
```

可以通过 `cat` 命令的 `-b` 选项来显示行号，例如：

```shell
$ cat -b filename
```

#### tac
反向查询文件内容，后面的行先输出
```shell
$ tac 文件名
```

#### tee

重复标准输入

```shell
tee [-ai] [file ...]
```
* -a 将输入追加到文件中，而不是覆写

举例:

```shell
# 将echo输出信息同时输出至stdout和greeting.txt
$ echo "Hello" | tee greeting.txt
```

#### umash

显示或设定文件模式掩码

上述的权限是在没有umask情况下的默认权限。但是系统为了保护用户创建文件和文件夹的权限,此时系统会有一个默认的用户掩码(umask)，大多数的Linux系统的默认掩码为022。用户掩码的作用是用户在创建文件时从文件的默认权限中去除掩码中的权限。所以文件创建之后的权限实际为: (文件0666,文件夹0777)-umask

所以在用户不修改umask的情况下，创建文件的权限为：0666-0022=0644。

创建文件夹的权限为：0777-0022=0755


```shell
# 查看掩码
$ umask

# 设置掩码为0022
$ umask 0022
```
* -S 直观查看默认权限

> https://blog.csdn.net/u014630623/article/details/88969570

## find 文件搜索

语法：find [搜索范围] [匹配条件]

| 匹配条件    | 说明                  | 
|---------|------------------------|
| -name   | 按照文件名查找             |
| -iname  | 按照文件名查找，忽略大小写   |
| -regex  | 使用正则表达式匹配          |
| -iregex | 使用正则表达式匹配，忽略大小写|
| -size   | 根据文件大小来查找          |
| -user   | 根据所有者查找             |
| -group  | 根据所属组查找             |

```shell
# 在目录/etc中查找文件init
$ find /etc -name init

# 在当前目录查找名称包含 linux 的文件
$ find . -iregex ".*linux.*"

# 1数据块512字节（0.5k），100M = 102400k = 204800数据块
#   +n 大于
#   -n 小于
#    n 等于

# 大于100M的文件
$ find / -size +204800

# 查找/home下所有所有者为bill的文件
$ find /home -user bill

# 在/etc下查找5分钟内被修改过属性和文件和目录
$ find /etc -cmin -5
#   -amin 访问时间access
#   -cmin 文件属性change
#   -mmin 文件内容modify
#   -type 根据文件类型查找，-type可选值有：
#       f 文件
#       d 目录
#       l 软连接文件
#   -inum 根据i节点查找


# 在/etc下查找大于80MB小于100MB的文件
$ find /etc -size +163840 -a -size -204800
#   -a 两个条件同时满足
#   -o 两个条件满足任意一个即可

# 在/etc下查找inittab文件并显示其详细信息
$find /etc -name inittab -exec ls -l {}\;
#   -exec/-ok 命令 {} \ ; 对搜索结果执行操作
```

#### locate

文件搜索，在文件资料库中查找文件；首次使用前需要使用下方命令建立索引、更新 `locate` 的资料库。

```shell
# linux
$ updatedb

# mac
$ sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.locate.plist
```

示例：

```shell
# 查找 nginx 默认配置文件
$ locate nginx.conf
```

#### which

搜索命令所在目录或别名信息（如果查找命令是存在别名显示别名的定义，不存在别名时显示命令的路径），示例：

```shell
# 查找 ls 命令程序的位置
$ which ls
```

#### whereis

搜索命令所在目录及帮助文档路径，示例：

```shell
# 查找 ls 命令程序的位置和文档的位置
$ whereis ls
```

#### apropos

查看一个配置文件的信息


#### whatis

查看命令简介

#### man

获得帮助信息

语法： `man [命令名称]`

相关命令：

* `man 1` 命令的帮助
* `man 5` 配置文件的帮助

#### 查看命令帮助

| 命令格式                | 功能                          |
|---------------------|-----------------------------|
| command --help      | 查看帮助                        |
| info command        | 查看帮助                        | 
| help                | 查看shell内置命令的帮助信息            |

